<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AyuRaksha - Sign Up</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: 'Inter', sans-serif; }
    .active-tab { background-color: #14b8a6; color: white; }
  </style>
</head>
<body class="bg-gray-50 flex items-center justify-center min-h-screen">

  <div class="bg-white shadow-lg rounded-lg w-full max-w-2xl p-8">
    <h1 class="text-2xl font-bold text-center text-teal-600 mb-6">Sign Up for AyuRaksha</h1>

    <!-- Message Div -->
    <div id="message" class="text-center text-green-600 font-bold mb-4"></div>

    <!-- Tabs -->
    <div class="flex justify-center mb-6">
      <button id="individualTab" class="px-6 py-2 font-semibold rounded-l-lg border active-tab">Individual</button>
      <button id="pharmacyTab" class="px-6 py-2 font-semibold rounded-r-lg border">Pharmacy</button>
    </div>

    <!-- Individual Form -->
    <form id="individualForm" class="space-y-4">
      <input id="indName" type="text" placeholder="Full Name" class="w-full border p-3 rounded-lg" required>
      <input id="indDob" type="date" class="w-full border p-3 rounded-lg" required>
      <input id="indState" type="text" placeholder="State" class="w-full border p-3 rounded-lg" required>
      <input id="indDistrict" type="text" placeholder="District" class="w-full border p-3 rounded-lg" required>
      <input id="indLocality" type="text" placeholder="Locality" class="w-full border p-3 rounded-lg" required>
      <input id="indEmail" type="email" placeholder="Email (Username)" class="w-full border p-3 rounded-lg" required>
      <input id="indPassword" type="password" placeholder="Password" class="w-full border p-3 rounded-lg" required>
      <input id="indConfirmPassword" type="password" placeholder="Confirm Password" class="w-full border p-3 rounded-lg" required>
      <button type="submit" class="w-full bg-teal-600 hover:bg-teal-700 text-white font-bold py-3 rounded-lg transition">
        Sign Up as Individual
      </button>
    </form>

    <!-- Pharmacy Form -->
    <form id="pharmacyForm" class="space-y-4 hidden">
      <input id="pharmaName" type="text" placeholder="Pharmacy Name" class="w-full border p-3 rounded-lg" required>
      <input id="pharmaReg" type="text" placeholder="Registration Number" class="w-full border p-3 rounded-lg" required>
      <input id="pharmaState" type="text" placeholder="State" class="w-full border p-3 rounded-lg" required>
      <input id="pharmaDistrict" type="text" placeholder="District" class="w-full border p-3 rounded-lg" required>
      <input id="pharmaLocality" type="text" placeholder="Locality" class="w-full border p-3 rounded-lg" required>
      <input id="pharmaEmail" type="email" placeholder="Email (Username)" class="w-full border p-3 rounded-lg" required>
      <input id="pharmaPassword" type="password" placeholder="Password" class="w-full border p-3 rounded-lg" required>
      <input id="pharmaConfirmPassword" type="password" placeholder="Confirm Password" class="w-full border p-3 rounded-lg" required>
      <button type="submit" class="w-full bg-teal-600 hover:bg-teal-700 text-white font-bold py-3 rounded-lg transition">
        Sign Up as Pharmacy
      </button>
    </form>
  </div>

  <script type="module">
    // Firebase SDK
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

    // Firebase Config with your Realtime Database URL
    const firebaseConfig = {
      apiKey: "AIzaSyBNtALT9E9wJWua8SHD16bxiom_UXnnZpU",
      authDomain: "ayuraksha-467a7.firebaseapp.com",
      projectId: "ayuraksha-467a7",
      storageBucket: "ayuraksha-467a7.appspot.com",
      messagingSenderId: "183036095329",
      appId: "1:183036095329:web:38130dd1cf348703ef3320",
      databaseURL: "https://ayuraksha-467a7-default-rtdb.firebaseio.com/"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const database = getDatabase(app);

    // Elements
    const individualTab = document.getElementById("individualTab");
    const pharmacyTab = document.getElementById("pharmacyTab");
    const individualForm = document.getElementById("individualForm");
    const pharmacyForm = document.getElementById("pharmacyForm");
    const messageDiv = document.getElementById("message");

    // Tab Toggle
    individualTab.addEventListener("click", () => {
      individualTab.classList.add("active-tab");
      pharmacyTab.classList.remove("active-tab");
      individualForm.classList.remove("hidden");
      pharmacyForm.classList.add("hidden");
      messageDiv.textContent = "";
    });

    pharmacyTab.addEventListener("click", () => {
      pharmacyTab.classList.add("active-tab");
      individualTab.classList.remove("active-tab");
      pharmacyForm.classList.remove("hidden");
      individualForm.classList.add("hidden");
      messageDiv.textContent = "";
    });

    // Individual Signup
    individualForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const email = document.getElementById("indEmail").value;
      const password = document.getElementById("indPassword").value;
      const confirmPassword = document.getElementById("indConfirmPassword").value;

      if(password !== confirmPassword){
        messageDiv.textContent = "Passwords do not match!";
        messageDiv.classList.add("text-red-600");
        return;
      }

      createUserWithEmailAndPassword(auth, email, password)
        .then(userCred => {
          const uid = userCred.user.uid;
          return set(ref(database, "users/individuals/" + uid), {
            name: document.getElementById("indName").value,
            dob: document.getElementById("indDob").value,
            country: "India",
            state: document.getElementById("indState").value,
            district: document.getElementById("indDistrict").value,
            locality: document.getElementById("indLocality").value,
            email: email
          });
        })
        .then(() => {
          messageDiv.classList.remove("text-red-600");
          messageDiv.classList.add("text-green-600");
          messageDiv.textContent = "Individual profile created successfully! Redirecting to login...";
          individualForm.reset();
          setTimeout(() => { window.location.href = "login.html"; }, 2000);
        })
        .catch(err => {
          messageDiv.textContent = "Error: " + err.message;
          messageDiv.classList.add("text-red-600");
        });
    });

    // Pharmacy Signup
    pharmacyForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const email = document.getElementById("pharmaEmail").value;
      const password = document.getElementById("pharmaPassword").value;
      const confirmPassword = document.getElementById("pharmaConfirmPassword").value;

      if(password !== confirmPassword){
        messageDiv.textContent = "Passwords do not match!";
        messageDiv.classList.add("text-red-600");
        return;
      }

      createUserWithEmailAndPassword(auth, email, password)
        .then(userCred => {
          const uid = userCred.user.uid;
          return set(ref(database, "users/pharmacies/" + uid), {
            pharmacyName: document.getElementById("pharmaName").value,
            regNumber: document.getElementById("pharmaReg").value,
            country: "India",
            state: document.getElementById("pharmaState").value,
            district: document.getElementById("pharmaDistrict").value,
            locality: document.getElementById("pharmaLocality").value,
            email: email
          });
        })
        .then(() => {
          messageDiv.classList.remove("text-red-600");
          messageDiv.classList.add("text-green-600");
          messageDiv.textContent = "Pharmacy profile created successfully! Redirecting to login...";
          pharmacyForm.reset();
          setTimeout(() => { window.location.href = "login.html"; }, 2000);
        })
        .catch(err => {
          messageDiv.textContent = "Error: " + err.message;
          messageDiv.classList.add("text-red-600");
        });
    });
  </script>
</body>
</html>
